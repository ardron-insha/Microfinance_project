summary_lowest20 <- as.data.frame(summary(lowincomesubset20))
colnames(summary_lowest20) <- c("delete", "Column", "Value")
summary_lowest20 <- summary_lowest20[, c("Column", "Value")]
summary_comparison <- cbind(summary, summary_lowest40$Value, summary_lowest20$Value)
colnames(summary_comparison) <- c("Variable", "Overall Value", "Lowest 2 QuartilesValue", "Lowest Quartile Value")
DT::datatable(summary_comparison)
DT::datatable(summary_comparison)
Findexdata$Respondent.is.male <- replace(Findexdata$Respondent.is.male,
Findexdata$Respondent.is.male=="2 female", "0")
Findexdata$Respondent.is.male <- as.factor(Findexdata$Respondent.is.male)
lowincomesubset40 <- Findexdata[Findexdata$Within.economy.household.income.quintile == "2 second 20%" |
Findexdata$Within.economy.household.income.quintile == "1 poorest 20%",]
summary_lowest40 <- as.data.frame(summary(lowincomesubset40))
colnames(summary_lowest40) <- c("delete", "Column", "Value")
summary_lowest40 <- summary_lowest40[, c("Column", "Value")]
lowincomesubset20 <- Findexdata[Findexdata$Within.economy.household.income.quintile == "2 second 20%",]
colnames(summary_lowest20) <- c("delete", "Column", "Value")
summary_comparison <- cbind(summary, summary_lowest40$Value, summary_lowest20$Value)
colnames(summary_comparison) <- c("Variable", "Overall Value", "Lowest 2 QuartilesValue", "Lowest Quartile Value")
DT::datatable(summary_comparison)
lowincomesubset40 <- Findexdata[Findexdata$Within.economy.household.income.quintile == "2 second 20%" |
Findexdata$Within.economy.household.income.quintile == "1 poorest 20%",]
summary_lowest40 <- as.data.frame(summary(lowincomesubset40))
colnames(summary_lowest40) <- c("delete", "Column", "Value")
summary_lowest40 <- summary_lowest40[, c("Column", "Value")]
lowincomesubset20 <- Findexdata[Findexdata$Within.economy.household.income.quintile == "2 second 20%",]
summary_lowest20 <- as.data.frame(summary(lowincomesubset20))
colnames(summary_lowest20) <- c("delete", "Column", "Value")
summary_lowest20 <- summary_lowest20[, c("Column", "Value")]
summary_comparison <- cbind(summary, summary_lowest40$Value, summary_lowest20$Value)
colnames(summary_comparison) <- c("Variable", "Overall Value", "Lowest 2 QuartilesValue", "Lowest Quartile Value")
lowincomesubset40 <- Findexdata[Findexdata$Within.economy.household.income.quintile == "2 second 20%" |
Findexdata$Within.economy.household.income.quintile == "1 poorest 20%",]
summary_lowest40 <- as.data.frame(summary(lowincomesubset40))
colnames(summary_lowest40) <- c("delete", "Column", "Value")
summary_lowest40 <- summary_lowest40[, c("Column", "Value")]
summary_lowest40 <- summary_lowest40[, c("Column", "Value")]
lowincomesubset20 <- Findexdata[Findexdata$Within.economy.household.income.quintile == "2 second 20%",]
summary_lowest20 <- as.data.frame(summary(lowincomesubset20))
colnames(summary_lowest20) <- c("delete", "Column", "Value")
summary_lowest20 <- summary_lowest20[, c("Column", "Value")]
summary_comparison <- cbind(summary, summary_lowest40$Value, summary_lowest20$Value)
colnames(summary_comparison) <- c("Variable", "Overall Value", "Lowest 2 QuartilesValue", "Lowest Quartile Value")
colnames(summary_comparison) <- c("Variable", "Overall Value", "Lowest 2 QuartilesValue", "Lowest Quartile Value")
colnames(summary_comparison) <- c("Overall Value", "Lowest 2 QuartilesValue", "Lowest Quartile Value")
gplot(Findexdata, aes(x=recipient.is.female))+ geom_bar(position="dodge") +
ggtitle("The number of survey respondents with accounts by household income quintile in 2014.") +
labs(x="The respondent has an account or does not", y="Count of survey respondents")
ggplot(Findexdata, aes(x=recipient.is.female))+ geom_bar(position="dodge") +
ggtitle("The number of survey respondents with accounts by household income quintile in 2014.") +
labs(x="The respondent has an account or does not", y="Count of survey respondents")
library("ggplot2", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
ggplot(Findexdata, aes(x=recipient.is.female))+ geom_bar(position="dodge") +
ggtitle("The number of survey respondents with accounts by household income quintile in 2014.") +
labs(x="The respondent has an account or does not", y="Count of survey respondents")
ggplot(Findexdata, aes(x=Respondent.is.male))+ geom_bar(position="dodge") +
ggtitle("The number of survey respondents with accounts by household income quintile in 2014.") +
labs(x="The respondent has an account or does not", y="Count of survey respondents")
ggplot(Findexdata, aes(x=Respondent.is.male))+ geom_bar(position="dodge") +
ggtitle("The split between male and female respondents in the Global Findex Survey in India (2014)") +
labs(x="Gender", y="Count of survey respondents")
Findexdata$Respondent.is.male <- factor(Findexdata$Respondent.is.male==1, labels=c("No", "Yes"))
qplot(Findexdata$Respondent.is.male, geom= "bar")
Findexdata$Respondent.is.male <- factor(Findexdata$Respondent.is.male==1, labels=c("Female", "Male"))
Findexdata$Respondent.is.male <- factor(Findexdata$Respondent.is.male==1, labels=c("Female", "Male"))
Finde
Findexdata$Respondent.is.male <- factor(Findexdata$Respondent.is.male==1, labels=c("No", "Yes"))
Findexdata$Respondent.is.male <- replace(Findexdata$Respondent.is.male,
Findexdata$Respondent.is.male=="1 male", "1")
Findexdata$Respondent.is.male <- replace(Findexdata$Respondent.is.male,
Findexdata$Respondent.is.male=="2 female", "0")
Findexdata$Respondent.is.male <- as.factor(Findexdata$Respondent.is.male)
Findexdata$Respondent.is.male <- factor(Findexdata$Respondent.is.male==1, labels=c("Female", "Male"))
Findexdata$Respondent.is.male <- replace(Findexdata$Respondent.is.male,
Findexdata$Respondent.is.male=="1 male", "1")
Findexdata$Respondent.is.male <- replace(Findexdata$Respondent.is.male,
Findexdata$Respondent.is.male=="1 male", "1")
Findexdata$Respondent.is.male <- replace(Findexdata$Respondent.is.male,
Findexdata$Respondent.is.male=="2 female", "0")
Findexdata$Respondent.is.male <- as.factor(Findexdata$Respondent.is.male)
ggplot(Findexdata, aes(x=Respondent.is.male))+ geom_bar(position="dodge") +
ggtitle("The split between male and female respondents in the Global Findex Survey in India (2014)") +
labs(x="Gender", y="Count of survey respondents")
colnames(Findexdata)[5] <- "Respondent.is.male"
Findexdata$Respondent.is.male <- replace(Findexdata$Respondent.is.male,
Findexdata$Respondent.is.male=="1 male", "Male")
Findexdata$Respondent.is.male <- replace(Findexdata$Respondent.is.male,
Findexdata$Respondent.is.male=="2 female", "Female")
Findexdata$Respondent.is.male <- as.factor(Findexdata$Respondent.is.male)
ggplot(Findexdata, aes(x=Respondent.is.male))+ geom_bar(position="dodge") +
ggtitle("The split between male and female respondents in the Global Findex Survey in India (2014)") +
labs(x="Gender", y="Count of survey respondents")
Findexdata$Respondent.age <- as.numeric(Findexdata$Respondent.age)
agebreaks <- c(0,1,5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,500)
agelabels <- c("0-1","1-4","5-9","10-14","15-19","20-24","25-29","30-34",
"35-39","40-44","45-49","50-54","55-59","60-64","65-69",
"70-74","75-79","80-84","85+")
setDT(Findexdata)[ ,agegroups := cut(Findexdata$Respondent.age,
breaks = agebreaks,
right = FALSE,
labels = agelabels)]
dat <- table(Findexdata$Respondent.is.female, Findexdata$Respondent.education.level, Findexdata$Within.economy.household.income.quintile, Findexdata$Has.an.account, Findexdata$agegroups)
summarylist <- list()
for(m in 1:length(dim(dat))){
martab <- margin.table(dat, margin=m)
summarylist[[m]] <- cbind(Freq=martab, Prop=prop.table(martab))
}
names(summarylist) <- names(dimnames(dat))
summarylist
Findexdata$Has.an.account <- replace(Findexdata$Has.an.account,
Findexdata$Has.an.account=="yes", "1")
Findexdata$Has.an.account <- replace(Findexdata$Has.an.account,
Findexdata$Has.an.account=="no", "0")
Findexdata$Has.an.account <- as.numeric(Findexdata$Has.an.account)
colnames(Findexdata)[5] <- "Respondent.is.male"
Findexdata$Respondent.is.male <- replace(Findexdata$Respondent.is.male,
Findexdata$Respondent.is.male=="1 male", "Male")
Findexdata$Respondent.is.male <- replace(Findexdata$Respondent.is.male,
Findexdata$Respondent.is.male=="2 female", "Female")
Findexdata$Respondent.is.male <- as.factor(Findexdata$Respondent.is.male)
ggplot(Findexdata, aes(x=Respondent.is.male))+ geom_bar(position="dodge") +
ggtitle("The split between male and female respondents in the Global Findex Survey in India (2014)") +
labs(x="Gender", y="Count of survey respondents")
ggplot(Findexdata, aes(x=Respondent.age))+ geom_bar(position="dodge") +
ggtitle("The split between male and female respondents in the Global Findex Survey in India (2014)") +
labs(x="Gender", y="Count of survey respondents")
ggplot(Findexdata, aes(x=Respondent.education.level))+ geom_bar(position="dodge") +
ggtitle("The split between male and female respondents in the Global Findex Survey in India (2014)") +
labs(x="Gender", y="Count of survey respondents")
ggplot(Findexdata, aes(x=Respondent.education.level))+ geom_bar(position="dodge") +
ggtitle("Education breakdown for respondents in the Global Findex Survey in India (2014)") +
labs(x="Gender", y="Count of survey respondents")
```{r, echo=FALSE, message= FALSE}
ggplot(Findexdata, aes(x=Findexdata$Within.economy.household.income.quintile))+ geom_bar(position="dodge") +
ggtitle("Income distributions for respondents in the Global Findex Survey in India (2014)") +
labs(x="Income quintile", y="Count of survey respondents")
ggplot(Findexdata, aes(x=Findexdata$agegroups))+ geom_bar(position="dodge") +
ggtitle("Income distributions for respondents in the Global Findex Survey in India (2014)") +
labs(x="Income quintile", y="Count of survey respondents")
lowincomesubset40 <- Findexdata[Findexdata$Within.economy.household.income.quintile == "2 second 20%" |
Findexdata$Within.economy.household.income.quintile == "1 poorest 20%",]
summary_lowest40 <- as.data.frame(summary(lowincomesubset40))
colnames(summary_lowest40) <- c("delete", "Column", "Value")
summary_lowest40 <- summary_lowest40[, c("Column", "Value")]
lowincomesubset20 <- Findexdata[Findexdata$Within.economy.household.income.quintile == "2 second 20%",]
summary_lowest20 <- as.data.frame(summary(lowincomesubset20))
colnames(summary_lowest20) <- c("delete", "Column", "Value")
summary_lowest20 <- summary_lowest20[, c("Column", "Value")]
summary_comparison <- cbind(summary, summary_lowest40$Value, summary_lowest20$Value)
colnames(summary_comparison) <- c("Overall Value", "Lowest 2 QuartilesValue", "Lowest Quartile Value")
summary(lowincomesubset40)
summary_lowest40 <- as.data.frame(summary(lowincomesubset40))
summary_lowest40
lowincomesubset40 <- Findexdata[Findexdata$Within.economy.household.income.quintile == "2 second 20%" |                             Findexdata$Within.economy.household.income.quintile == "1 poorest 20%",]
dat <- table(lowincomesubset40$Respondent.is.female, lowincomesubset40$Respondent.education.level, lowincomesubset40$Within.economy.household.income.quintile, lowincomesubset40$Has.an.account, lowincomesubset40$agegroups)
View(lowincomesubset20)
View(lowincomesubset20)
View(lowincomesubset40)
View(lowincomesubset40)
lowincomesubset40$Respondent.is.female
dat <- table(lowincomesubset40$Respondent.is.male, lowincomesubset40$Respondent.education.level, lowincomesubset40$Within.economy.household.income.quintile, lowincomesubset40$Has.an.account, lowincomesubset40$agegroups)
ggplot(Findexdata, aes(x=Findexdata$Has.an.account))+ geom_bar(position="dodge") +
ggtitle("Number of respondents with a bank account in the Global Findex Survey in India (2014)") +
labs(x="Income quintile", y="Count of survey respondents")
str(Findexdata$Has.an.account)
summary(Findexdata$Has.an.account)
ggplot(Findexdata, aes(x=Findexdata$Has.an.account))+ geom_bar(position="dodge") +
ggtitle("Number of respondents with a bank account in the Global Findex Survey in India (2014)") +
labs(x="Respondent has account", y="Count of survey respondents")
lowincomesubset20 <- Findexdata[Findexdata$Within.economy.household.income.quintile == "1 poorest 20%",]
dat <- table(lowincomesubset20$Respondent.is.male, lowincomesubset20$Respondent.education.level, lowincomesubset20$Has.an.account, lowincomesubset20$agegroups)
summarylist <- list()
for(m in 1:length(dim(dat))){
martab <- margin.table(dat, margin=m)
summarylist[[m]] <- cbind(Freq=martab, Prop=prop.table(martab))
}
names(summarylist) <- names(dimnames(dat))
summarylist
ggplot(Findexdata, aes(x=Respondent.is.male, fill=Has.an.account))+ geom_bar(position="dodge")
lowincomesubset20 <- Findexdata[                             Findexdata$Within.economy.household.income.quintile == "1 poorest 20%",]
womenonly <- Findexdata[which(Findexdata$Respondent.is.male==0), ]
sum(womenonly$Has.an.account==1)/length(womenonly$Has.an.account)
womenonly <- Findexdata[which(Findexdata$Respondent.is.male=="Female"), ]
sum(womenonly$Has.an.account==1)/length(womenonly$Has.an.account)
womenonly <- Findexdata[which(Findexdata$Respondent.is.male=="Female"), ]
womenonly
Findexdata$Respondent.is.male <- replace(Findexdata$Respondent.is.male,
Findexdata$Respondent.is.male=="1 male", "Male")
Findexdata$Respondent.is.male <- replace(Findexdata$Respondent.is.male,
Findexdata$Respondent.is.male=="2 female", "Female")
Findexdata$Respondent.is.male <- as.factor(Findexdata$Respondent.is.male)
Findexdata$Respondent.is.male <- replace(Findexdata$Respondent.is.male,
Findexdata$Respondent.is.male=="1 male", "1")
Findexdata$Respondent.is.male <- as.factor(Findexdata$Respondent.is.male)
womenonly <- Findexdata[which(Findexdata$Respondent.is.male==0), ]
sum(womenonly$Has.an.account==1)/length(womenonly$Has.an.account)
menonly <- Findexdata[which(Findexdata$Respondent.is.male==1), ]
sum(menonly$Has.an.account==1)/length(menonly$Has.an.account)
womenonly <- Findexdata[which(Findexdata$Respondent.is.male==0), ]
sum(womenonly$Has.an.account==1)/length(womenonly$Has.an.account)
ff = function(x){
y = data.frame(t(table(x)))
y$Var1 = NULL
names(y) = c("Levels","Freq")
return(y)
}
dd = do.call(rbind, apply(highincomesubset20, 2, ff))
highincomesubset40 <- Findexdata[Findexdata$Within.economy.household.income.quintile == "5 richest 20%" |
Findexdata$Within.economy.household.income.quintile == "4 fourth 20%",]
summary(highincomesubset40)
summary(highincomesubset40)
highincomesubset20 <- Findexdata[Findexdata$Within.economy.household.income.quintile == "5 richest 20%",]
highincomesubset20 <- Findexdata[Findexdata$Within.economy.household.income.quintile == "5 richest 20%",]
ff = function(x){
y = data.frame(t(table(x)))
y$Var1 = NULL
names(y) = c("Levels","Freq")
return(y)
}
highincomesubset20 <- as.factor(highincomesubset20)
highincomesubset20[,5:84] <- as.factor(highincomesubset20[,5:84])
highincomesubset20 %>%
mutate_all(as.factor)
library("dplyr", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
highincomesubset20 %>%
mutate_all(as.factor)
dd = do.call(rbind, apply(highincomesubset20, 2, ff))
dd = do.call(rbind, apply(highincomesubset20, 2, ff))
highincomesubset20 %>%
mutate_all(as.factor)
dd = do.call(rbind, apply(highincomesubset20, 2, ff))
dd
names <- c(5:84)
highincomesubset20[,names] <- lapply(highincomesubset20[,names] , factor)
names <- c(5:84)
highincomesubset20[,names] <- lapply(highincomesubset20[,names] , factor)
highincomesubset20[,5:84] <- lapply(highincomesubset20[,5:84] , factor)
dd = do.call(rbind, apply(highincomesubset20, 2, ff))
dd
count.yes.per.col <- ldply(highincomesubset20, function(c) sum(c=="yes"))
library(plyr)
count.yes.per.col <- ldply(highincomesubset20, function(c) sum(c=="yes"))
count.yes.per.col
library(ggplot2)
count.yes.high.inc <-
ggplot(count.yes.per.col, aes(x=.id, y=V1)) +
geom_bar(stat="identity", colour="black", fill="white") +
xlab("") + ylab("")
count.yes.high.inc
library(purrr)
library(tidyr)
library(ggplot2)
highincomesubset20 %>%
keep(is.numeric) %>%
gather() %>%
ggplot(aes(value)) +
facet_wrap(~ key, scales = "free") +
geom_histogram()
highincomesubset20 %>%
keep() %>%
gather() %>%
ggplot(aes(value)) +
facet_wrap(~ key, scales = "free") +
geom_histogram()
highincomesubset20 %>%
keep(is.factor()) %>%
gather() %>%
ggplot(aes(value)) +
facet_wrap(~ key, scales = "free") +
geom_histogram()
highincomesubset20 %>%
keep(is.factor) %>%
gather() %>%
ggplot(aes(value)) +
facet_wrap(~ key, scales = "free") +
geom_histogram()
highincomesubset20 %>%
keep(is.factor, is.numeric) %>%
gather() %>%
ggplot(aes(value)) +
facet_wrap(~ key, scales = "free") +
geom_histogram()
highincomesubset20 %>%
keep(is.factor) %>%
gather() %>%
ggplot(aes(value)) +
facet_wrap(~ key, scales = "free") +
geom_histogram()
highincomesubset20 %>%
keep(is.factor) %>%
gather() %>%
ggplot(aes(value)) +
facet_wrap(~ key, scales = "free") +
geom_histogram() +
stat= "count"
library(purrr)
library(tidyr)
library(ggplot2)
highincomesubset20 %>%
keep(is.factor) %>%
gather() %>%
ggplot(aes(value)) +
facet_wrap(~ key, scales = "free") +
geom_histogram() +
stat= "count"
highincomesubset20 %>%
keep(is.factor) %>%
gather() %>%
ggplot(aes(value)) +
facet_wrap(~ key, scales = "free") +
geom_bar() +
sum(highincomesubset20$Has.an.account==1)/length(highincomesubset20$Has.an.account)
highincomesubset20 %>%
keep(is.factor) %>%
gather() %>%
ggplot(aes(value)) +
facet_wrap(~ key, scales = "free") +
geom_bar() +
highincomesubset20 %>%
keep(is.factor) %>%
gather() %>%
ggplot(aes(value)) +
facet_wrap(~ key, scales = "free") +
geom_bar()
highincomesubset20 %>%
keep(is.factor) %>%
gather() %>%
ggplot(aes(value)) +
facet_wrap(~ key, scales = "free") +
geom_histogramn(binwidth= 0.5 )
highincomesubset20 %>%
keep(is.factor) %>%
gather() %>%
ggplot(aes(value)) +
facet_wrap(~ key, scales = "free") +
geom_histogram(binwidth= 0.5 )
ggplot(lowincomesubset20, aes(x=Has.an.account, fill=Respondent.is.male))+ geom_bar(position="dodge")
sum(lowincomesubset20$Has.an.account==1)/length(lowincomesubset20$Has.an.account)
low20women <- lowincomesubset20[lowincomesubset20$Respondent.is.male==0,][,]
sum(low20women$Has.an.account==1)/length(low20women$Has.an.account)
low20women <- lowincomesubset20[lowincomesubset20$Respondent.is.male==0,][,]
sum(low20women$Has.an.account==1)/length(low20women$Has.an.account)
sum(lowincomesubset20$Has.an.account==1)/length(lowincomesubset20$Has.an.account)
Findexdata$Respondent.is.male <- replace(Findexdata$Respondent.is.male,
Findexdata$Respondent.is.male=="1 male", "1")
Findexdata$Respondent.is.male <- replace(Findexdata$Respondent.is.male,
Findexdata$Respondent.is.male=="2 female", "0")
Findexdata$Respondent.is.male <- as.factor(Findexdata$Respondent.is.male)
womenonly <- Findexdata[which(Findexdata$Respondent.is.male==0), ]
sum(womenonly$Has.an.account==1)/length(womenonly$Has.an.account)
menonly <- Findexdata[which(Findexdata$Respondent.is.male==1), ]
sum(menonly$Has.an.account==1)/length(menonly$Has.an.account)
ggplot(lowincomesubset20, aes(x=Has.an.account, fill=Respondent.is.male))+ geom_bar(position="dodge")
sum(lowincomesubset20$Has.an.account==1)/length(lowincomesubset20$Has.an.account)
low20women <- lowincomesubset20[lowincomesubset20$Respondent.is.male==0,][,]
sum(low20women$Has.an.account==1)/length(low20women$Has.an.account)
View(lowincomesubset20)
View(lowincomesubset20)
View(lowincomesubset20)
ggplot(lowincomesubset20, aes(x=Has.an.account, fill=Respondent.is.male))+ geom_bar(position="dodge")
library("ggplot2", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
ggplot(lowincomesubset20, aes(x=Has.an.account, fill=Respondent.is.male))+ geom_bar(position="dodge")
sum(lowincomesubset20$Has.an.account==1)/length(lowincomesubset20$Has.an.account)
low20women <- lowincomesubset20[lowincomesubset20$Respondent.is.male==0,][,]
sum(low20women$Has.an.account==1)/length(low20women$Has.an.account)
low20women <- lowincomesubset20[lowincomesubset20$Respondent.is.male==0,][,]
low20women <- lowincomesubset20[lowincomesubset20$Respondent.is.male=='no',][,]
sum(low20women$Has.an.account==1)/length(low20women$Has.an.account)
low20women <- lowincomesubset20[lowincomesubset20$Respondent.is.male=='no',][,]
low20women
View(low20women)
View(low20women)
low20women <- lowincomesubset20[lowincomesubset20$Respondent.is.male=='No',][,]
sum(low20women$Has.an.account==1)/length(low20women$Has.an.account)
low20men <- lowincomesubset20[lowincomesubset20$Respondent.is.male=='Yes',][,]
sum(low20men$Has.an.account==1)/length(low20men$Has.an.account)
```{r, echo=FALSE, message= FALSE}
ggplot(Findexdata, aes(x=Respondent.is.male, fill=Has.an.account))+ geom_bar(position="dodge")
ggplot(lowincomesubset20, aes(x=Has.an.account, fill=Respondent.is.male))+ geom_bar(position="dodge")
ggplot(Findexdata, aes(x=Has.an.account, fill=Respondent.is.male))+ geom_bar(position="dodge")
womenonly <- Findexdata[which(Findexdata$Respondent.is.male==0), ]
PRINT(sum(womenonly$Has.an.account==1)/length(womenonly$Has.an.account))
womenonly <- Findexdata[which(Findexdata$Respondent.is.male==0), ]
sum(womenonly$Has.an.account==1)/length(womenonly$Has.an.account)
womenonly <- Findexdata[which(Findexdata$Respondent.is.male=='No'), ]
sum(womenonly$Has.an.account==1)/length(womenonly$Has.an.account)
ggplot(findexdata, aes(x=Has.an.account, fill=Within.economy.household.income.quintile))+ geom_bar(position="dodge")
ggplot(Findexdata, aes(x=Has.an.account, fill=Within.economy.household.income.quintile))+ geom_bar(position="dodge")
ggplot(Findexdata, aes(x=Has.an.account, fill=Within.economy.household.income.quintile== '1 Poorest 20%' && '5 Richest 20%'))+ geom_bar(position="dodge")
ggplot(Findexdata, aes(x=Has.an.account, fill=Within.economy.household.income.quintile== '1 Poorest 20%' || '5 Richest 20%'))+ geom_bar(position="dodge")
ggplot(Findexdata, aes(x=Has.an.account, fill=Within.economy.household.income.quintile== '1 Poorest 20%' | '5 Richest 20%'))+ geom_bar(position="dodge")
ggplot(Findexdata, aes(x=Has.an.account, fill=Within.economy.household.income.quintile== '1 Poorest 20%' & '5 Richest 20%'))+ geom_bar(position="dodge")
Findexdata$Within.economy.household.income.quintile <- as.factor(Findexdata$Within.economy.household.income.quintile)
highincomesubset20[,5:84] <- lapply(highincomesubset20[,5:84] , factor)
ggplot(Findexdata, aes(x=Has.an.account, fill=Within.economy.household.income.quintile== '1 Poorest 20%' & '5 Richest 20%'))+ geom_bar(position="dodge")
ggplot(Findexdata, aes(x=Has.an.account, fill=Within.economy.household.income.quintile== '1 Poorest 20%'&'5 Richest 20%'))+ geom_bar(position="dodge")
ggplot(Findexdata, aes(x=Has.an.account, fill=Within.economy.household.income.quintile== '1 Poorest 20%'&&'5 Richest 20%'))+ geom_bar(position="dodge")
ggplot(Findexdata, aes(x=Has.an.account, fill=Within.economy.household.income.quintile[,'1 Poorest 20%'&'5 Richest 20%']))+ geom_bar(position="dodge")
ggplot(Findexdata, aes(x=Has.an.account, fill=Within.economy.household.income.quintile[,'1 poorest 20%'&'5 richest 20%']))+ geom_bar(position="dodge")
highandlowsubset <- Findexdata[Findexdata$Within.economy.household.income.quintile == "5 richest 20%" |
Findexdata$Within.economy.household.income.quintile == "4 fourth 20%" |  Findexdata$Within.economy.household.income.quintile == "2 second 20%" | Findexdata$Within.economy.household.income.quintile == "1 poorest 20%"  ]
highincomesubset40 <- Findexdata[Findexdata$Within.economy.household.income.quintile == "5 richest 20%" |
Findexdata$Within.economy.household.income.quintile == "4 fourth 20%",]
highandlowsubset <- Findexdata[Findexdata$Within.economy.household.income.quintile == "5 richest 20%" |
Findexdata$Within.economy.household.income.quintile == "4 fourth 20%" |  Findexdata$Within.economy.household.income.quintile == "2 second 20%" | Findexdata$Within.economy.household.income.quintile == "1 poorest 20%" , ]
ggplot(highandlowsubset, aes(x=Has.an.account, fill=Within.economy.household.income.quintile))+ geom_bar(position="dodge")
ggplot(highandlowsubset, aes(x=Within.economy.household.income.quintile, fill=Has.an.account))+ geom_bar(position="dodge")
highandlowsubset$Has.an.account <- as.factor(highandlowsubset$Has.an.account)
highandlowsubset$Has.an.account <- as.factor(highandlowsubset$Has.an.account)
ggplot(highandlowsubset, aes(x=Within.economy.household.income.quintile, fill=Has.an.account))+ geom_bar(position="dodge")
high40 <- highandlowsubset[highandlowsubset$Within.economy.household.income.quintile=='1 Richest 20%',][,]
sum(high40$Has.an.account==1)
high40 <- highandlowsubset[highandlowsubset$Within.economy.household.income.quintile=='1 Richest 20%',][,]
sum(high40$Has.an.account=='1')
high40 <- highandlowsubset[highandlowsubset$Within.economy.household.income.quintile=='1 Richest 20%',][,]
high40 <- highandlowsubset[highandlowsubset$Within.economy.household.income.quintile=='1 richest 20%',][,]
sum(high40$Has.an.account=='1')
View(highandlowsubset)
View(highandlowsubset)
high40 <- highandlowsubset[highandlowsubset$Within.economy.household.income.quintile=='5 richest 20%',][,]
sum(high40$Has.an.account=='1')
low20 <- highandlowsubset[highandlowsubset$Within.economy.household.income.quintile=='1 poorest 20%',][,]
sum(low20$Has.an.account=='1')
accountsatupperinc <- sum(high20$Has.an.account=='1')
high20 <- highandlowsubset[highandlowsubset$Within.economy.household.income.quintile=='5 richest 20%',][,]
accountsatupperinc <- sum(high20$Has.an.account=='1')
accountsatlowerinc <- sum(low20$Has.an.account=='1')
accountsatupperinc/accountsatlowerinc
sum(lowincomesubset20$Saved.in.past.12.months..for.education.or.school.fees=="yes")/sum(lowincomesubset20$Has.an.account== 1)
sum(highincomesubset20$Saved.in.past.12.months..for.education.or.school.fees=="yes")/sum(highincomesubset20$Has.an.account== 1)
sum(Findexdata$Has.an.account==1)/length(Findexdata$Has.an.account)
View(Findexdata)
Findexdata[,16:24] %>%
keep(is.factor) %>%
gather() %>%
ggplot(aes(value)) +
facet_wrap(~ key, scales = "free") +
geom_bar()
library(purrr)
library(tidyr)
library(ggplot2)
Findexdata[,16:24] %>%
keep(is.factor) %>%
gather() %>%
ggplot(aes(value)) +
facet_wrap(~ key, scales = "free") +
geom_bar()
n_yes <- data.frame(type = names(Findexdata[,16:24]),
total_yes = colSums(Findexdata[,16:24] == "yes"))
ggplot(n_yes, aes(x = type, y = total_yes)) +
geom_bar(stat = "identity")
sum(highincomesubset20$Saved.in.past.12.months..for.education.or.school.fees=="yes")/sum(highincomesubset20$Has.an.account== 1)
sum(highincomesubset20$Borrowed.in.past.12.months..for.education.or.school.fees=="yes")/sum(highincomesubset20$Has.an.account== 1)
sum(lowincomesubset20$Borrowed.in.past.12.months..for.education.or.school.fees=="yes")/sum(lowincomesubset20$Has.an.account== 1)
sum(womenonly$Borrowed.in.past.12.months..for.education.or.school.fees=="yes")/sum(womenonly$Has.an.account== 1)
sum(menonly$Borrowed.in.past.12.months..for.education.or.school.fees=="yes")/sum(menonly$Has.an.account== 1)
sum(menonly$Saved.in.past.12.months..for.education.or.school.fees=="yes")/sum(menonly$Has.an.account== 1)
sum(menonly$Has.an.account==1)/length(menonly$Has.an.account)
womenonly <- Findexdata[which(Findexdata$Respondent.is.male=='No'), ]
sum(womenonly$Has.an.account==1)/length(womenonly$Has.an.account)
menonly <- Findexdata[which(Findexdata$Respondent.is.male=='Yes'), ]
sum(menonly$Has.an.account==1)/length(menonly$Has.an.account)
sum(menonly$Borrowed.in.past.12.months..for.education.or.school.fees=="yes")/sum(menonly$Has.an.account== 1)
sum(Findexdata$Has.an.account==1)/length(Findexdata$Has.an.account)
womenonly <- Findexdata[which(Findexdata$Respondent.is.male=='No'), ]
sum(womenonly$Has.an.account==1)/length(womenonly$Has.an.account)
sum(menonly$Has.an.account==1)/length(menonly$Has.an.account)
ggplotgrob(Findexdata, aes(x=Respondent.is.male))+ geom_bar(position="dodge") +
ggtitle("The split between male and female respondents in the Global Findex Survey in India (2014)") +
labs(x="Gender", y="Count of survey respondents")
ggplotGrob(Findexdata, aes(x=Respondent.is.male))+ geom_bar(position="dodge") +
ggtitle("The split between male and female respondents in the Global Findex Survey in India (2014)") +
labs(x="Gender", y="Count of survey respondents")
ggplot(Findexdata, aes(x=Respondent.is.male))+ geom_bar(position="dodge") +
ggtitle("The split between male and female respondents in the Global Findex Survey in India (2014)") +
labs(x="Gender", y="Count of survey respondents")
library("ggplot2", lib.loc="/Library/Frameworks/R.framework/Versions/3.4/Resources/library")
ggplot(Findexdata, aes(x=Respondent.is.male))+ geom_bar(position="dodge") +
ggtitle("The split between male and female respondents in the Global Findex Survey in India (2014)") +
labs(x="Gender", y="Count of survey respondents")
ggplot(Findexdata, aes(x=Respondent.is.male))+ geom_bar(position="dodge") +
ggtitle("The split between male and female respondents in the Global Findex Survey in India (2014)") +
labs(x="Gender", y="Count of survey respondents")
Findexdata$Respondent.is.male <- replace(Findexdata$Respondent.is.male,
Findexdata$Respondent.is.male=="2 female", "Female")
Findexdata$Respondent.is.male <- as.factor(Findexdata$Respondent.is.male)
Findexdata$Respondent.is.male <- replace(Findexdata$Respondent.is.male,
Findexdata$Respondent.is.male=="1 male", "Male")
Findexdata$Respondent.is.male <- replace(Findexdata$Respondent.is.male,
Findexdata$Respondent.is.male=="2 female", "Female")
Findexdata$Respondent.age <- as.numeric(Findexdata$Respondent.age)
agebreaks <- c(0,1,5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,500)
agelabels <- c("0-1","1-4","5-9","10-14","15-19","20-24","25-29","30-34",
"35-39","40-44","45-49","50-54","55-59","60-64","65-69",
"70-74","75-79","80-84","85+")
setDT(Findexdata)[ ,agegroups := cut(Findexdata$Respondent.age,
breaks = agebreaks,
right = FALSE,
labels = agelabels)]
Findexdata$Has.an.account <- replace(Findexdata$Has.an.account,
Findexdata$Has.an.account=="yes", "1")
Findexdata$Has.an.account <- replace(Findexdata$Has.an.account,
Findexdata$Has.an.account=="no", "0")
Findexdata$Has.an.account <- as.numeric(Findexdata$Has.an.account)
colnames(Findexdata)[5] <- "Respondent.is.male"
Findexdata$Respondent.is.male <- replace(Findexdata$Respondent.is.male,
Findexdata$Respondent.is.male=="1 male", "Male")
Findexdata$Respondent.is.male <- replace(Findexdata$Respondent.is.male,
Findexdata$Respondent.is.male=="2 female", "Female")
ggplot(Findexdata, aes(x=Respondent.is.male))+ geom_bar(position="dodge") +
ggtitle("The split between male and female respondents in the Global Findex Survey in India (2014)") +
labs(x="Gender", y="Count of survey respondents")
